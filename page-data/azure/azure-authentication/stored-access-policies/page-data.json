{
    "componentChunkName": "component---node-modules-gatsby-theme-kb-src-templates-topic-js",
    "path": "/azure/azure-authentication/stored-access-policies",
    "result": {"data":{"file":{"childMdx":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"tags\": \"az-204, authentication, shared-access-signature, sas\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Stored Access Policies\"), mdx(\"p\", null, \"A stored access policy provides an extra level of control over service-level \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"/shared-access-signatures\",\n    \"title\": \"shared-access-signatures\"\n  }, \"[[shared-access-signatures]]\"), \" on the server side.\"), mdx(\"p\", null, \"With stored access policy you can group SAS and provides more restrictions for signatures that bound by the policy.\"), mdx(\"p\", null, \"You can use a stored access policy to change the start time, expiry time, or permissions for a signature, or to revoke it after it is issued.\"), mdx(\"p\", null, \"Stored Access Policies are supported by Blob containers, File shares, Queues, Tables.\"), mdx(\"p\", null, \"To create or modify a stored access policy, call the Set ACL operation for the resource (see Set Container ACL, Set Queue ACL, Set Table ACL, or Set Share ACL) with a request body that specifies the terms of the access policy. The body of the request includes a unique signed identifier of your choosing, up to 64 characters in length, and the optional parameters of the access policy.\"), mdx(\"div\", {\n    \"className\": \"gatsby-highlight\",\n    \"data-language\": \"cs\"\n  }, mdx(\"pre\", {\n    parentName: \"div\",\n    \"className\": \"language-cs\"\n  }, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-cs\"\n  }, mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token class-name\"\n  }, \"BlobSignedIdentifier\"), \" identifier \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"new\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token constructor-invocation class-name\"\n  }, \"BlobSignedIdentifier\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n    Id \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"stored access policy identifier\\\"\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n    AccessPolicy \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"new\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token constructor-invocation class-name\"\n  }, \"BlobAccessPolicy\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \"\\n        ExpiresOn \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" DateTimeOffset\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), \"UtcNow\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"AddHours\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token number\"\n  }, \"1\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \",\"), \"\\n        Permissions \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token operator\"\n  }, \"=\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token string\"\n  }, \"\\\"rw\\\"\"), \"\\n    \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), \"\\n\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\"), \"\\n\\nblobContainer\", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \".\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token function\"\n  }, \"SetAccessPolicy\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"(\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token named-parameter punctuation\"\n  }, \"permissions\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \":\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token keyword\"\n  }, \"new\"), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token constructor-invocation class-name\"\n  }, \"BlobSignedIdentifier\", mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"[\"), mdx(\"span\", {\n    parentName: \"span\",\n    \"className\": \"token punctuation\"\n  }, \"]\")), \" \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"{\"), \" identifier \", mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \"}\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \")\"), mdx(\"span\", {\n    parentName: \"code\",\n    \"className\": \"token punctuation\"\n  }, \";\")))));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"","private":false},"tableOfContents":{"items":[{"url":"#stored-access-policies","title":"Stored Access Policies"}]},"outboundReferences":[{"contextLine":"A stored access policy provides an extra level of control over service-level [[shared-access-signatures]] on the server side.","targetAnchor":null,"refWord":"shared-access-signatures","target":{"body":"var _excluded = [\"components\"];\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"tags\": \"az-204, authentication, shared-access-signature, sas\"\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, _excluded);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", null, \"Shared Access Signatures\"), mdx(\"p\", null, \"A shared access signature (SAS) is a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"signed URI\"), \" that points to one or more storage resources and includes a token that contains a special set of query parameters.\"), mdx(\"p\", null, \"The token indicates how the resources might be accessed by the client. One of the query parameters, the signature, is constructed from the SAS parameters and signed with the key that was used to create the SAS. This signature is used by Azure Storage to authorize access to the storage resource.\"), mdx(\"p\", null, \"There are three types of shared access signatures:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"User delegation SAS\"), \": A user delegation SAS is \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"secured with Microsoft Entra credentials\"), \" and also by the permissions specified for the SAS. A user delegation SAS applies to Blob storage only.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Service SAS\"), \": A service SAS is secured with the storage account key. A service SAS delegates access to a resource.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Account SAS\"), \": An account SAS is secured with the storage account key. All of the operations available via a service or user delegation SAS are also available via an account SAS.\")), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"Note\"), \": When your application design requires shared access signatures for access to Blob storage, use Microsoft Entra credentials to create a user delegation SAS when possible for superior security.\"), mdx(\"h2\", null, \"SAS in query string\"), mdx(\"p\", null, \"When you access an element using a SAS, you pass it via query string.\"), mdx(\"p\", null, \"For example, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"https://medicalrecords.blob.core.windows.net/patient-images/patient-116139-nq8z7f.jpg?sp=r&st=2020-01-20T11:42:32Z&se=2020-01-20T19:42:32Z&spr=https&sv=2019-02-02&sr=b&sig=SrW1HZ5Nb6MbRzTbXCaPm%2BJiSEn15tC91Y4umMPwVZs%3D\"), \" is made up of two parts: the URI (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"https://medicalrecords.blob.core.windows.net/patient-images/patient-116139-nq8z7f.jpg\"), \") and the SAS token (\", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"sp=r&st=2020-01-20T11:42:32Z&se=2020-01-20T19:42:32Z&spr=https&sv=2019-02-02&sr=b&sig=SrW1HZ5Nb6MbRzTbXCaPm%2BJiSEn15tC91Y4umMPwVZs%3D\"), \").\"), mdx(\"p\", null, \"The SAS token is made up of several parts:\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Component\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Description\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"sp=r\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Controls the access rights. The values can be \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"a\"), \" for add, \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"c\"), \" for create, \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"d\"), \" for delete, \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"l\"), \" for list, \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"r\"), \" for read, or \", mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"w\"), \" for write. This example is read only. The example sp=acdlrw grants all the available rights.\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"st=2020-01-20T11:42:32Z\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"The date and time when access starts.\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"se=2020-01-20T19:42:32Z\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"The date and time when access ends. This example grants eight hours of access.\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"sv=2019-02-02\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"The version of the storage API to use.\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"sr=b\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"The kind of storage being accessed. In this example, b is for blob.\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, mdx(\"inlineCode\", {\n    parentName: \"td\"\n  }, \"sig=SrW1HZ5Nb6MbRzTbXCaPm%2BJiSEn15tC91Y4umMPwVZs%3D\")), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"The cryptographic signature.\")))), mdx(\"p\", null, \"There are some best practices to follow:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"To securely distribute a SAS and prevent man-in-the-middle attacks, \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"always use HTTPS\"), \".\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"The most secure SAS is a user delegation SAS\"), \". Use it wherever possible because it removes the need to store your storage account key in code. You must use Microsoft Entra ID to manage credentials. This option might not be possible for your solution.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Try to \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"set your expiration time to the smallest useful value\"), \". If a SAS key becomes compromised, it can be exploited for only a short time.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"Apply the rule of minimum-required privileges\"), \". Only grant the access that's required. For example, in your app, read-only access is sufficient.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"There are some situations where a SAS isn't the correct solution. When there's an unacceptable risk of using a SAS, create a middle-tier service to manage users and their access to storage.\")), mdx(\"h2\", null, \"When to use SAS?\"), mdx(\"p\", null, \"A common scenario where a SAS is useful is a service where users read and write their own data to your storage account.\"), mdx(\"p\", null, \"In a scenario where a storage account stores user data, there are two typical design patterns, that can be mixed depending on the needs.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Clients upload and download data via a \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"front-end proxy service\"), \", which performs authentication. This front-end proxy service has the advantage of allowing validation of business rules, but for large amounts of data or high-volume transactions, creating a service that can scale to match demand may be expensive or difficult.\")), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://learn.microsoft.com/en-us/training/wwl-azure/implement-shared-access-signatures/media/storage-proxy-service.png\",\n    \"alt\": \"Scenario with frontend proxy\"\n  })), mdx(\"ol\", {\n    \"start\": 2\n  }, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"A lightweight service authenticates the client\"), \" as needed and then generates a SAS. Once the client application receives the SAS, they can access storage account resources directly with the permissions defined by the SAS and for the interval allowed by the SAS. \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"The SAS mitigates the need for routing all data through the front-end proxy service\"), \".\")), mdx(\"p\", null, mdx(\"img\", {\n    parentName: \"p\",\n    \"src\": \"https://learn.microsoft.com/en-us/training/wwl-azure/implement-shared-access-signatures/media/storage-provider-service.png\",\n    \"alt\": \"Scenario with lightweight SAS provider service\"\n  })));\n}\n;\nMDXContent.isMDXComponent = true;","parent":{"id":"94d2b2d7-fb6b-582d-a753-b8e0c9884662","fields":{"slug":"/azure/azure-authentication/shared-access-signatures","title":"Shared Access Signatures"}}}}],"inboundReferences":[{"contextLine":"  - [[stored-access-policies]]","referrer":{"parent":{"id":"054932f3-ea86-5292-9b43-2c04a7a196ec","fields":{"slug":"/azure-certifications/az-204","title":"AZ-204 - Developing Solutions for Microsoft Azure"}}}}]},"fields":{"slug":"/azure/azure-authentication/stored-access-policies","title":"Stored Access Policies"}}},"pageContext":{"id":"4e4dfdba-f3b5-5b5c-843d-974143c6f496","refWordMdxSlugDict":{"shared-access-signatures":"azure/azure-authentication/shared-access-signatures"},"tocTypes":["sidebar"]}},
    "staticQueryHashes": ["2221750479","2380733210","2768355698","63159454","847517413"]}